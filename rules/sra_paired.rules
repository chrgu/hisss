# -*- mode: Snakemake -*-

rule download_sra:
	output:
		r1=temp(str(DATA_DIR+"/{sample}_1.fastq")),
		r2=temp(str(DATA_DIR+"/{sample}_2.fastq"))
	params:
		outdir = str(DATA_DIR+"/"),
		samp = str('{sample}')
	shell:
		"""
		if fastq-dump --split-3 --skip-technical -I -O {params.outdir} {params.samp}; then
			echo "download success"
		else
			echo "download failed, sleeping"
			sleep 60
			exit 1
		fi
		"""


rule download_only:
	input:
		r1 = lambda wildcards: DATA_DIR+"/"+config["samples"][wildcards.sample][0],
		r2 = lambda wildcards: DATA_DIR+"/"+config["samples"][wildcards.sample][1]
	output:
		temp(str(DATA_DIR+'/summary.txt'))
	shell:
		"""
		touch {output}
		"""
