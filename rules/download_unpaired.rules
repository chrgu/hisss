# -*- mode: Snakemake -*-

rule split_samples:
	input:
		str(config["io"]["file_list"])
	output:
		str(DATA_DIR+"/targets/{sample}"),
	params:
		outdir = str(OUTPUT_DIR+"/download/targets/")
	run:
		f = open(input[0],"r")
		shell("mkdir -p " + params.outdir)
		for l in f.readlines():
			info = [i.strip() for i in l.split(",")]
			r = open(params.outdir+info[0],"w")
			r.write(info[1])
			r.close()

rule grab_data:
	input:
		o = rules.split_samples.output,
		r = str(DATA_DIR+"/targets/{sample}")
	output:
		str(DATA_DIR+"/{sample}.fastq.gz"),
	shell:
		"""
		wget -O {output} `cat {input.r}`
		"""

rule format_data:
	input:
		str(DATA_DIR+"/{sample}.fastq.gz"),
	output:
		str(DATA_DIR+"/{sample}.fastq")
	shell:
		"""
		gunzip {input}
		"""
